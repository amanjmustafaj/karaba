import streamlit as st

class ژمێریارییکارەبا:
    """کلاسێک بۆ ژمێرینی نرخی کارەبا"""
    
    def __init__(self):
        # نرخەکانی کارەبای ماڵان (دینار بۆ هەر kWh)
        self.نرخی_نزم = 72        # بۆ 0-400 kWh
        self.نرخی_مامناوەند = 108  # بۆ 401-800 kWh
        self.نرخی_بەرز = 175       # بۆ زیاتر لە 800 kWh
        
        # نرخی کارەبای بازرگانی
        self.نرخی_بازرگانی = 150
    
    def حیسابی_ماڵان(self, kwh):
        """
        ژمێرینی نرخی کارەبای ماڵان
        
        پارامەتەر:
            kwh: بڕی کارەبای بەکارهاتوو بە کیلۆوات کاتژمێر
            
        گەڕاندنەوە:
            فەرهەنگێک کە کۆی گشتی و وردەکاریەکانی تێدایە
        """
        وردەکاری = []
        
        if kwh <= 400:
            # هەموو بڕەکە بە نرخی نزم حیساب دەکرێت
            کۆ = kwh * self.نرخی_نزم
            وردەکاری.append({
                'بەش': 'بەشی یەکەم',
                'بڕ': kwh,
                'نرخ': self.نرخی_نزم,
                'کۆ': کۆ
            })
            
        elif kwh <= 800:
            # 400 کیلۆواتی یەکەم بە نرخی نزم
            بەشی_یەکەم = 400 * self.نرخی_نزم
            وردەکاری.append({
                'بەش': 'بەشی یەکەم',
                'بڕ': 400,
                'نرخ': self.نرخی_نزم,
                'کۆ': بەشی_یەکەم
            })
            
            # بڕی ماوە بە نرخی مامناوەند
            بەشی_دووەم = (kwh - 400) * self.نرخی_مامناوەند
            وردەکاری.append({
                'بەش': 'بەشی دووەم',
                'بڕ': kwh - 400,
                'نرخ': self.نرخی_مامناوەند,
                'کۆ': بەشی_دووەم
            })
            
            کۆ = بەشی_یەکەم + بەشی_دووەم
            
        else:
            # 400 کیلۆواتی یەکەم بە نرخی نزم
            بەشی_یەکەم = 400 * self.نرخی_نزم
            وردەکاری.append({
                'بەش': 'بەشی یەکەم (0-400 kWh)',
                'بڕ': 400,
                'نرخ': self.نرخی_نزم,
                'کۆ': بەشی_یەکەم
            })
            
            # 400 کیلۆواتی دووەم بە نرخی مامناوەند
            بەشی_دووەم = 400 * self.نرخی_مامناوەند
            وردەکاری.append({
                'بەش': 'بەشی دووەم (401-800 kWh)',
                'بڕ': 400,
                'نرخ': self.نرخی_مامناوەند,
                'کۆ': بەشی_دووەم
            })
            
            # بڕی ماوە بە نرخی بەرز
            بەشی_سێیەم = (kwh - 800) * self.نرخی_بەرز
            وردەکاری.append({
                'بەش': 'بەشی سێیەم (زیاتر لە 800 kWh)',
                'بڕ': kwh - 800,
                'نرخ': self.نرخی_بەرز,
                'کۆ': بەشی_سێیەم
            })
            
            کۆ = بەشی_یەکەم + بەشی_دووەم + بەشی_سێیەم
        
        return {'کۆی_گشتی': کۆ, 'وردەکاری': وردەکاری}
    
    def حیسابی_بازرگانی(self, kwh):
        """
        ژمێرینی نرخی کارەبای بازرگانی
        
        پارامەتەر:
            kwh: بڕی کارەبای بەکارهاتوو
            
        گەڕاندنەوە:
            فەرهەنگێک کە کۆی گشتی و وردەکاریەکانی تێدایە
        """
        کۆ = kwh * self.نرخی_بازرگانی
        وردەکاری = [{
            'بەش': 'کارەبای بازرگانی',
            'بڕ': kwh,
            'نرخ': self.نرخی_بازرگانی,
            'کۆ': کۆ
        }]
        
        return {'کۆی_گشتی': کۆ, 'وردەکاری': وردەکاری}


def سەرەکی():
    """فەنکشنی سەرەکی بۆ ڕێکخستنی ڕووکاری بەکارهێنەر"""
    
    # ڕێکخستنی پەڕە
    st.set_page_config(
        page_title="ژمێریاری کارەبا",
        page_icon="⚡",
        layout="centered"
    )
    
    # سەرناو
    st.title("⚡ سیستەمی ژمێرینی نرخی کارەبا")
    st.markdown("---")
    
    # دروستکردنی ژمێریار
    ژمێریار = ژمێریارییکارەبا()
    
    # بەشی هەڵبژاردنی جۆری بەکارهێنەر
    st.subheader("١. جۆری بەکارهێنەر هەڵبژێرە")
    
    جۆری_بەکارهێنەر = st.radio(
        "تکایە جۆری بەکارهێنەرت هەڵبژێرە:",
        options=['ماڵان', 'بازرگانی'],
        horizontal=True,
        help="کارەبای ماڵان نرخی جیاوازە لە کارەبای بازرگانی"
    )
    
    st.markdown("---")
    
    # بەشی نووسینی بڕی کارەبا
    st.subheader("٢. بڕی کارەبای بەکارهاتوو بنووسە")
    
    بڕی_کارەبا = st.number_input(
        "بڕی کارەبا بە کیلۆوات کاتژمێر (kWh):",
        min_value=0,
        max_value=100000,
        value=0,
        step=10,
        help="ئەم ژمارەیە لەسەر پسوڵەی کارەبادا دەبینیتەوە"
    )
    
    st.markdown("---")
    
    # نیشاندانی ئەنجام
    if بڕی_کارەبا > 0:
        st.subheader("٣. ئەنجامی ژمێریاری")
        
        # ژمێرینی نرخ بەپێی جۆری بەکارهێنەر
        if جۆری_بەکارهێنەر == 'ماڵان':
            ئەنجام = ژمێریار.حیسابی_ماڵان(بڕی_کارەبا)
            
            # نیشاندانی وردەکاری
            if len(ئەنجام['وردەکاری']) > 1:
                st.info("📊 **وردەکاری ژمێریاریەکە:**")
                
                for بەش in ئەنجام['وردەکاری']:
                    with st.container():
                        col1, col2, col3 = st.columns([2, 2, 2])
                        with col1:
                            st.write(f"**{بەش['بەش']}**")
                        with col2:
                            st.write(f"{بەش['بڕ']:,} kWh × {بەش['نرخ']} دینار")
                        with col3:
                            st.write(f"**{بەش['کۆ']:,} دینار**")
                
                st.markdown("---")
        
        else:  # بازرگانی
            ئەنجام = ژمێریار.حیسابی_بازرگانی(بڕی_کارەبا)
            
            st.info(f"📊 **ژمێریاری:** {بڕی_کارەبا:,} kWh × {ژمێریار.نرخی_بازرگانی} دینار")
            st.markdown("---")
        
        # نیشاندانی کۆی گشتی
        st.success(f"### 💰 کۆی گشتی: **{ئەنجام['کۆی_گشتی']:,} دینار عێراقی**")
        
        # زانیاریی زیادە
        with st.expander("ℹ️ زانیاریی زیادە"):
            if جۆری_بەکارهێنەر == 'ماڵان':
                st.markdown("""
                **نرخەکانی کارەبای ماڵان:**
                - بۆ 0-400 kWh: 72 دینار بۆ هەر kWh
                - بۆ 401-800 kWh: 108 دینار بۆ هەر kWh  
                - بۆ زیاتر لە 800 kWh: 175 دینار بۆ هەر kWh
                """)
            else:
                st.markdown("""
                **نرخی کارەبای بازرگانی:**
                - نرخی یەکسان: 150 دینار بۆ هەر kWh
                """)
    
    else:
        st.info("👆 تکایە بڕی کارەبای بەکارهاتوو بنووسە بۆ بینینی ئەنجام")
    
    # پێی پەڕە
    st.markdown("---")
    st.caption("🔌 سیستەمی ژمێرینی نرخی کارەبا - هەرێمی کوردستان")


# جێبەجێکردنی پرۆگرامەکە
if __name__ == "__main__":
    سەرەکی()
